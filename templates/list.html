{% extends "base.html" %}
{% load bt %}
{% load i18n %}
{% block styles %}
{% endblock %}
{% block scripts %}
  <script type="text/javascript" src="{%media_url%}/js/jquery.1.4.2.min.js"></script>
  <script type="text/javascript" src="{%media_url%}/js/jquery.tablesorter.min.js"> </script>
  <script type="text/javascript" src="{%media_url%}/js/picnet.table.filter.min.js"></script>
  <script type="text/javascript">
   $(document).ready(function() {
     $("#sortedlist").tablesorter();
     $('#sortedlist').tableFilter();
     $('.confirm_form').submit(function() {
       var self=this;
       $.ajax({url: '/confirm/'+$(this).attr('id')+'/'+$(this).children('input:first').attr('value'), success: function(data) { $(self).html(data); }});
       return false;
     });
   });
  </script>
{% endblock %}

{%block content%}
<div id='container'>
{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}
<table class="listing tablesorter" id='sortedlist'>
  <thead>
<tr>
   <th filter='false'>{% trans "id" %}</th>
   <th filter-type='ddl'>{% trans "country" %}</th>
   <th filter-type='ddl'>{% trans "operator" %}</th>
   <th filter-type='ddl'>{% trans "contract" %}</th>
   <th filter-type='ddl'>{% trans "resource" %}</th>
   <th filter-type='ddl'>{% trans "type" %}</th>
   <th filter-type='ddl'>{% trans "media" %}</th>
   <th filter-type='ddl'>{% trans "temporary" %}</th>
   <th filter-type='ddl'>{% trans "contractual" %}</th>
   <th filter='false'>{% trans "contractual_excerpt" %}</th>
   <th filter-type='ddl'>{% trans "loophole" %}</th>
   <th filter='false'>{% trans "confirmations" %}</th>
</tr>
  </thead>
  <tbody>
{% for violation in violations.object_list %}
<tr>
    <td><a href="/view/{{violation.pk}}">#{{ violation.pk }}</a></td>
    <td>{{ violation.country }}</td>
    <td>{{ violation.operator }}</td>
    <td>{{ violation.contract }}</td>
    <td>{{ violation.resource }}</td>
    <td>{{ violation.type }}</td>
    <td>{{ violation.media }}</td>
    <td>{{ violation.temporary }}</td>
    <td>{{ violation.contractual }}</td>
    <td>{{ violation.contractual_excerpt }}</td>
    <td>{{ violation.loophole }}</td>
    <td>{{ violation.confirmations }} <div class="confirm"><a>+1</a>
          <div class="hidden confirm_popup">
             <h3>Confirmation</h3>
             <p>
             <form method="get" class="confirm_form" id="{{ violation.pk }}">
                E-mail: <input type="text" name="email" /><br />
                //required<br />
                <input type="hidden" value="{{ violation.pk }}" />
                <input type="submit" value="confirm" />
             </form>
             </p>
          </div>
       </div>
    </td>
</tr>
{% endfor %}
  </tbody>
</table>

<div class="pagination">
    <span class="step-links">
        {% if violations.has_previous %}
            <a href="?page={{ violations.previous_page_number }}">previous</a>
        {% endif %}

        <span class="current">
           {% trans "Page" %} {{ violations.number }} {% trans "of" %} {{ violations.paginator.num_pages }}.
        </span>

        {% if violations.has_next %}
        <a href="?page={{ violations.next_page_number }}">{% trans "next" %}</a>
        {% endif %}
    </span>
</div>
</div>
{%endblock%}
